#!/usr/bin/perl -w -I/opt/eprints/perl_lib

######################################################################
#
#  List the emails of all archive users
#
#  Usage: list_user_emails
#
######################################################################
#
#  __COPYRIGHT__
#
# Copyright 2000-2008 University of Southampton. All Rights Reserved.
# 
# __LICENSE__
#
######################################################################

use EPrints::Session;
use EPrints::User;

use strict;
#cjg Nice Command Options
#cjg man page
 
# Set STDOUT to auto flush (without needing a \n)
$|=1;

my $session = new EPrints::Session( 1, $ARGV[0] );
exit( 1 ) unless( defined $session );

my $user_ds = $session->get_archive()->get_dataset( "user" );
$user_ds->map( $session, \&print_user_email );
my @users = $session->get_db()->get_all( $user_ds );

$session->terminate();

sub print_user_email
{
	my( $user ) = @_;
	
	print $user->get_value( "email" )."\n";
}
