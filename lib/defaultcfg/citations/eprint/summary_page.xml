<?xml version="1.0" ?>

<!-- 
	Full citation for an eprint. 
-->

<cite:citation xmlns="http://www.w3.org/1999/xhtml" xmlns:epc="http://eprints.org/ep3/control" xmlns:cite="http://eprints.org/ep3/citation" >

  <p class="ep_block" style="margin-bottom: 1em">
    <epc:print expr="$item.citation('default')" />
  </p>

  <epc:if test="$flags{has_multiple_versions}">
    <div class="ep_block" style="margin-bottom: 1em">
      <epc:print expr="$multi_info" />
    </div>
  </epc:if>

  <epc:if test="length($documents) = 0">
    <epc:phrase ref="page:nofulltext" />
    <epc:if test="$item.contact_email().is_set() and eprint_status = 'archive'">
      (<a href="{$config{http_cgiurl}}/request_doc?eprintid={eprintid}"><epc:phrase ref="request:button" /></a>)
    </epc:if>
  </epc:if>

  <epc:if test="length($documents) gt 0">
    <epc:phrase ref="page:fulltext" />
    <table>
      <epc:foreach expr="$documents" iterator="doc">
        <tr>
          <td valign="top" align="right"><epc:print expr="$doc.icon(1,0)}" /></td>
          <td valign="top">
            <epc:print expr="$doc.citation('default')" /><br />
            <a href="{$doc.url()}">Download (<epc:print expr="$doc.doc_size().human_filesize()" />)</a>
            <epc:if test="$doc.is_public() and $doc.thumbnail_url('preview').is_set()">| <epc:print expr="$doc.preview_link($doc.citation_link('default'),'docs')" /></epc:if>
            <epc:if test="!$doc.is_public() and $item.contact_email().is_set() and eprint_status = 'archive'">
              | <a href="{$config{http_cgiurl}}/request_doc?docid={$doc{docid}"><epc:phrase ref="request:button" /></a>
            </epc:if>

            <ul>
            <epc:foreach expr="$doc.related_objects('http://eprints.org/relation/hasVersion')" iterator="rel">
            <li><epc:print expr="$rel.citation_link('default')" /></li>
            </epc:foreach>
            </ul>
          </td>
        </tr>
      </epc:foreach>
    </table>
  </epc:if>

  <epc:if test="official_url">
    <div class="ep_block" style="margin-bottom: 1em">
      <epc:phrase ref="eprint_fieldname_official_url"/>: <epc:print expr="official_url" />
    </div>
  </epc:if>

  <epc:if test="abstract">
    <div class="ep_block">
      <h2><epc:phrase ref="eprint_fieldname_abstract"/></h2>
      <p style="text-align: left; margin: 1em auto 0em auto"><epc:print expr="abstract" /></p>
    </div>
  </epc:if>

  <table style="margin-bottom: 1em; margin-top: 1em;" cellpadding="3">
    <tr>
      <th align="right"><epc:phrase ref="eprint_fieldname_type" />:</th>
      <td>
        <epc:print expr="type" />
        <epc:if test="type = 'conference_item'">(<epc:print expr="pres_type" />)</epc:if>
        <epc:if test="type = 'monograph'">(<epc:print expr="monograph_type" />)</epc:if>
        <epc:if test="type = 'thesis'">(<epc:print expr="thesis_type" />)</epc:if>
      </td>
    </tr>
    <epc:comment> 
       The below block loops over a list of field names taken from eprint_render.pl
       Edit the list of metadata to show in the summary page table in eprint_render.pl
    </epc:comment>
    <epc:foreach expr="$config{summary_page_metadata}" iterator="fieldname">
      <epc:if test="$item.property($fieldname)">
        <tr>
          <th align="right"><epc:phrase ref="eprint_fieldname_{$fieldname}" />:</th>
          <td valign="top"><epc:print expr="$item.property($fieldname)" /></td>
        </tr>
      </epc:if>
    </epc:foreach>
  </table>

  <epc:if test="$flags{has_multiple_versions}">
    <epc:phrase ref="page:available_versions" />
    <epc:print expr="$version_tree" />
  </epc:if>
  <epc:if test="$flags{in_commentary_thread}">
    <epc:phrase ref="page:commentary_threads" />
    <epc:print expr="$commentary_tree" />
  </epc:if>

  <epc:if test="!$flags{preview}">
    <p style="text-align: right">Repository Staff Only: <a href="{$item.control_url()}">Item Control Page</a></p>
  </epc:if>

</cite:citation>

